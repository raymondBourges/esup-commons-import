<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:e="http://commons.esup-portail.org"
	xmlns:p="http://primefaces.prime.com.tr/ui" 
	template="/stylesheets/template.xhtml">

	
    <ui:define name="content">
		<h:outputFormat value="#{msgs['TODO_DEMO.PRIVATE.INTRODUCTION']}">
			<f:param value="#{todoPrivateController.currentUserId}"/>
		</h:outputFormat>
		<p:growl id="growl" showDetail="true" />
		<h:form id="tasksFormPaginator">
			<p:dataTable id="tabletasks" value="#{taskController.userTasks}"
				var="task" >
				<f:facet name="header">
					<e:paginator id="paginatorTasksHead" paginator="#{userTasksPaginator}"
						itemsName="#{msgs['TODO_DEMO.TASKS']}" reRender="tasksFormPaginator" />
				</f:facet>
				<f:facet name="footer">
					<e:paginator id="paginatorTasksFooter" paginator="#{userTasksPaginator}"
						itemsName="#{msgs['TODO_DEMO.TASKS']}" itemsNumbersFlag="#{false}"
						itemsPerPageFlag="#{false}" reRender="tasksFormPaginator" />
				</f:facet>
				<p:column>
					<f:facet name="header">
						<h:outputText value="#{msgs['TODO_DEMO.TASK.ID']}" />
					</f:facet>
					<h:outputText value="#{task.id}" />
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="#{msgs['TODO_DEMO.TASK.TITLE']}" />
					</f:facet>
					<h:outputText value="#{task.title}" />
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="#{msgs['TODO_DEMO.TASK.DESCRIPTION']}" />
					</f:facet>
					<h:outputText value="#{task.description}" />
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="#{msgs['TODO_DEMO.TASK.OWNER']}" />
					</f:facet>
					<h:outputText value="#{task.owner.id} : #{task.owner.displayName}" />
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="#{msgs['TODO_DEMO.TASK.ASSIGNATEDUSER']}" />
					</f:facet>
					<ui:repeat value="#{task.assignatedUsers}" var="assignatedUsers">
						<h:outputText
							value="#{assignatedUsers.id} : #{assignatedUsers.displayName}" />
						<br/>
					</ui:repeat>
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="#{msgs['TODO_DEMO.FORM.TASK.ACTION']}" />
					</f:facet>
					<p:commandButton value="#{msgs['TODO_DEMO.FORM.ACTION.DELETETASK']}" update="@form,growl"
						action="#{taskController.deleteTask}" >
						<f:setPropertyActionListener value="#{task}"
							target="#{taskController.taskToDelete}" />
					</p:commandButton>
					<p:commandButton value="#{msgs['TODO_DEMO.FORM.ACTION.MODIFYTASK']}" action="#{taskController.editTask}" update="@form,growl,formEditTask"
						onclick="dialogEditTask.show();">
						<f:setPropertyActionListener value="#{task}"
							target="#{taskController.taskToEdit}" />
					</p:commandButton>
				</p:column>
			</p:dataTable>
			
		</h:form>
				
		<div><p:commandButton value="#{msgs['TODO_DEMO.FORM.ACTION.CREATETASK']}" onclick="dialogCreateTask.show();" type="button"/> </div>
			</ui:define>
		<ui:define name="hidden-div">
			<ui:include src="/stylesheets/private/todo_private_create_task_dialog.xhtml" />
 			<ui:include src="/stylesheets/private/todo_private_edit_task_dialog.xhtml" />
	</ui:define>
</ui:composition> 
